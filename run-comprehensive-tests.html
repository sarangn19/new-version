<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comprehensive Quality Assurance Tests</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  
  <!-- All Production Components -->
  <script src="js/error-handler.js"></script>
  <script src="js/offline-manager.js"></script>
  <script src="js/performance-optimizer.js"></script>
  <script src="js/final-performance-optimizer.js"></script>
  <script src="js/loading-state-manager.js"></script>
  <script src="js/validation-system.js"></script>
  <script src="js/profile-manager.js"></script>
  <script src="js/enhanced-bookmark-manager.js"></script>
  <script src="js/enhanced-note-manager.js"></script>
  <script src="js/data-exporter.js"></script>
  <script src="js/backup-manager.js"></script>
  <script src="js/import-handler.js"></script>
  <script src="js/study-tools.js"></script>
  <script src="js/performance-analyzer.js"></script>
  <script src="js/report-generator.js"></script>
  <script src="js/progress-visualizer.js"></script>
  <script src="js/weakness-identifier.js"></script>
  
  <!-- Stylesheets -->
  <link href="styles/glassmorphism.css" rel="stylesheet">
  <link href="styles/unified-theme.css" rel="stylesheet">
  <link href="styles/accessibility.css" rel="stylesheet">
  <link href="styles/theme-system.css" rel="stylesheet">
  
  <style>
    :root {
      --bg-dark-1: #1F1F1F;
      --bg-dark-2: #1A1A1A;
      --teal-primary: #2C7A7B;
    }
    
    body {
      background: linear-gradient(135deg, #1F1F1F 0%, #2D3748 100%);
      color: white;
      font-family: 'Inter', sans-serif;
      min-height: 100vh;
    }
    
    .test-section {
      background: rgba(26, 26, 26, 0.8);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 1rem;
      padding: 2rem;
      margin-bottom: 2rem;
    }
    
    .test-result {
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      margin: 0.5rem 0;
      font-family: 'Courier New', monospace;
      font-size: 0.85rem;
      border-left: 4px solid;
    }
    
    .test-pass {
      background-color: rgba(34, 197, 94, 0.1);
      border-color: rgba(34, 197, 94, 0.5);
      color: rgb(34, 197, 94);
    }
    
    .test-fail {
      background-color: rgba(239, 68, 68, 0.1);
      border-color: rgba(239, 68, 68, 0.5);
      color: rgb(239, 68, 68);
    }
    
    .test-info {
      background-color: rgba(59, 130, 246, 0.1);
      border-color: rgba(59, 130, 246, 0.5);
      color: rgb(59, 130, 246);
    }
    
    .test-warning {
      background-color: rgba(245, 158, 11, 0.1);
      border-color: rgba(245, 158, 11, 0.5);
      color: rgb(245, 158, 11);
    }
    
    .progress-bar {
      width: 100%;
      height: 12px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      overflow: hidden;
      margin: 1rem 0;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #2C7A7B, #38B2AC, #4FD1C7);
      transition: width 0.5s ease;
      width: 0%;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin: 1rem 0;
    }
    
    .stat-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 0.5rem;
      padding: 1rem;
      text-align: center;
    }
    
    .stat-value {
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
    }
    
    .stat-label {
      font-size: 0.875rem;
      opacity: 0.7;
    }
  </style>
</head>
<body class="p-8">
  <div class="max-w-7xl mx-auto">
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold mb-4 bg-gradient-to-r from-teal-400 to-blue-400 bg-clip-text text-transparent">
        Comprehensive Quality Assurance Test Suite
      </h1>
      <p class="text-xl text-gray-300">
        Final testing and validation of all platform features
      </p>
    </div>
    
    <!-- Overall Progress -->
    <div class="test-section">
      <h2 class="text-2xl font-semibold mb-4 flex items-center gap-2">
        <i data-lucide="activity" class="w-6 h-6"></i>
        Overall Test Progress
      </h2>
      <div class="progress-bar">
        <div id="overall-progress" class="progress-fill"></div>
      </div>
      <p id="progress-text" class="text-center mt-2 text-lg">Initializing test environment...</p>
      
      <div class="stats-grid mt-6">
        <div class="stat-card">
          <div id="total-tests" class="stat-value text-blue-400">0</div>
          <div class="stat-label">Total Tests</div>
        </div>
        <div class="stat-card">
          <div id="passed-tests" class="stat-value text-green-400">0</div>
          <div class="stat-label">Passed</div>
        </div>
        <div class="stat-card">
          <div id="failed-tests" class="stat-value text-red-400">0</div>
          <div class="stat-label">Failed</div>
        </div>
        <div class="stat-card">
          <div id="success-rate" class="stat-value text-teal-400">0%</div>
          <div class="stat-label">Success Rate</div>
        </div>
      </div>
    </div>
    
    <!-- Component Initialization Tests -->
    <div class="test-section">
      <h2 class="text-2xl font-semibold mb-4 flex items-center gap-2">
        <i data-lucide="cpu" class="w-6 h-6"></i>
        Component Initialization & Availability
      </h2>
      <div id="component-tests"></div>
    </div>
    
    <!-- Cross-Browser Compatibility Tests -->
    <div class="test-section">
      <h2 class="text-2xl font-semibold mb-4 flex items-center gap-2">
        <i data-lucide="globe" class="w-6 h-6"></i>
        Cross-Browser Compatibility
      </h2>
      <div id="browser-tests"></div>
    </div>
    
    <!-- Performance Benchmarks -->
    <div class="test-section">
      <h2 class="text-2xl font-semibold mb-4 flex items-center gap-2">
        <i data-lucide="zap" class="w-6 h-6"></i>
        Performance Benchmarks
      </h2>
      <div id="performance-tests"></div>
    </div>
    
    <!-- Accessibility Compliance -->
    <div class="test-section">
      <h2 class="text-2xl font-semibold mb-4 flex items-center gap-2">
        <i data-lucide="accessibility" class="w-6 h-6"></i>
        Accessibility Compliance (WCAG 2.1 AA)
      </h2>
      <div id="accessibility-tests"></div>
    </div>
    
    <!-- Security Validation -->
    <div class="test-section">
      <h2 class="text-2xl font-semibold mb-4 flex items-center gap-2">
        <i data-lucide="shield" class="w-6 h-6"></i>
        Security Validation
      </h2>
      <div id="security-tests"></div>
    </div>
    
    <!-- Data Integrity Tests -->
    <div class="test-section">
      <h2 class="text-2xl font-semibold mb-4 flex items-center gap-2">
        <i data-lucide="database" class="w-6 h-6"></i>
        Data Integrity & Backup/Restore
      </h2>
      <div id="data-tests"></div>
    </div>
    
    <!-- User Workflow Tests -->
    <div class="test-section">
      <h2 class="text-2xl font-semibold mb-4 flex items-center gap-2">
        <i data-lucide="users" class="w-6 h-6"></i>
        Complete User Workflows
      </h2>
      <div id="workflow-tests"></div>
    </div>
    
    <!-- Final Report -->
    <div class="test-section">
      <h2 class="text-2xl font-semibold mb-4 flex items-center gap-2">
        <i data-lucide="file-text" class="w-6 h-6"></i>
        Final Test Report
      </h2>
      <div id="final-report"></div>
      <div class="mt-6 text-center">
        <button id="export-report" class="bg-gradient-to-r from-teal-600 to-blue-600 hover:from-teal-700 hover:to-blue-700 text-white px-6 py-3 rounded-lg font-semibold">
          Export Test Report
        </button>
      </div>
    </div>
  </div>

  <script>
    // Comprehensive Test Suite
    class ComprehensiveTestSuite {
      constructor() {
        this.totalTests = 0;
        this.passedTests = 0;
        this.failedTests = 0;
        this.testResults = new Map();
        this.startTime = performance.now();
        
        this.init();
      }
      
      async init() {
        this.updateProgress();
        await this.runAllTests();
      }
      
      async runAllTests() {
        try {
          await this.testComponentInitialization();
          await this.testBrowserCompatibility();
          await this.testPerformanceBenchmarks();
          await this.testAccessibilityCompliance();
          await this.testSecurityValidation();
          await this.testDataIntegrity();
          await this.testUserWorkflows();
          
          this.generateFinalReport();
        } catch (error) {
          this.logTest('Test Suite', `Critical error: ${error.message}`, 'fail', 'final-report');
        }
      }
      
      async testComponentInitialization() {
        const container = document.getElementById('component-tests');
        this.logTest('Component Tests', 'Testing component initialization...', 'info', container);
        
        const components = [
          'ErrorHandler',
          'OfflineManager', 
          'PerformanceOptimizer',
          'FinalPerformanceOptimizer',
          'LoadingStateManager',
          'ValidationSystem',
          'ProfileManager',
          'EnhancedBookmarkManager',
          'EnhancedNoteManager',
          'DataExporter',
          'BackupManager',
          'ImportHandler'
        ];
        
        let initializedComponents = 0;
        
        for (const componentName of components) {
          try {
            if (window[componentName]) {
              const instance = new window[componentName]();
              if (instance) {
                initializedComponents++;
                this.logTest('Component Init', `${componentName} initialized successfully`, 'pass', container);
              }
            } else {
              this.logTest('Component Init', `${componentName} class not available`, 'fail', container);
            }
          } catch (error) {
            this.logTest('Component Init', `${componentName} failed: ${error.message}`, 'fail', container);
          }
        }
        
        const successRate = (initializedComponents / components.length) * 100;
        this.logTest('Component Summary', `${initializedComponents}/${components.length} components initialized (${successRate.toFixed(1)}%)`, 
          successRate >= 90 ? 'pass' : 'fail', container);
      }
      
      async testBrowserCompatibility() {
        const container = document.getElementById('browser-tests');
        this.logTest('Browser Tests', 'Testing browser compatibility...', 'info', container);
        
        // Test modern browser features
        const features = [
          { name: 'localStorage', test: () => typeof Storage !== 'undefined' },
          { name: 'Fetch API', test: () => typeof fetch !== 'undefined' },
          { name: 'Promises', test: () => typeof Promise !== 'undefined' },
          { name: 'ES6 Classes', test: () => { try { eval('class Test {}'); return true; } catch { return false; } } },
          { name: 'CSS Custom Properties', test: () => CSS.supports('color', 'var(--test)') },
          { name: 'Intersection Observer', test: () => 'IntersectionObserver' in window },
          { name: 'Performance Observer', test: () => 'PerformanceObserver' in window },
          { name: 'Service Worker', test: () => 'serviceWorker' in navigator }
        ];
        
        let supportedFeatures = 0;
        
        for (const feature of features) {
          try {
            const isSupported = feature.test();
            if (isSupported) {
              supportedFeatures++;
              this.logTest('Browser Feature', `${feature.name} supported`, 'pass', container);
            } else {
              this.logTest('Browser Feature', `${feature.name} not supported`, 'warning', container);
            }
          } catch (error) {
            this.logTest('Browser Feature', `${feature.name} test failed: ${error.message}`, 'fail', container);
          }
        }
        
        const compatibilityScore = (supportedFeatures / features.length) * 100;
        this.logTest('Browser Summary', `${supportedFeatures}/${features.length} features supported (${compatibilityScore.toFixed(1)}%)`, 
          compatibilityScore >= 80 ? 'pass' : 'warning', container);
      }
      
      async testPerformanceBenchmarks() {
        const container = document.getElementById('performance-tests');
        this.logTest('Performance Tests', 'Running performance benchmarks...', 'info', container);
        
        // Test 1: Page Load Performance
        const loadTime = performance.now() - this.startTime;
        this.logTest('Load Time', `Page loaded in ${Math.round(loadTime)}ms`, 
          loadTime < 3000 ? 'pass' : 'warning', container);
        
        // Test 2: Memory Usage
        if (performance.memory) {
          const memoryMB = performance.memory.usedJSHeapSize / 1024 / 1024;
          this.logTest('Memory Usage', `${memoryMB.toFixed(2)}MB heap used`, 
            memoryMB < 50 ? 'pass' : 'warning', container);
        }
        
        // Test 3: DOM Operations Performance
        const domStart = performance.now();
        for (let i = 0; i < 1000; i++) {
          const div = document.createElement('div');
          div.textContent = `Test ${i}`;
          document.body.appendChild(div);
          document.body.removeChild(div);
        }
        const domTime = performance.now() - domStart;
        this.logTest('DOM Operations', `1000 DOM operations in ${Math.round(domTime)}ms`, 
          domTime < 100 ? 'pass' : 'warning', container);
        
        // Test 4: Component Performance
        if (window.FinalPerformanceOptimizer) {
          const optimizer = new FinalPerformanceOptimizer();
          const report = optimizer.getPerformanceReport();
          
          if (report.coreWebVitals.LCP && report.coreWebVitals.LCP < 2500) {
            this.logTest('Core Web Vitals', `LCP: ${Math.round(report.coreWebVitals.LCP)}ms`, 'pass', container);
          }
          
          if (report.coreWebVitals.FID && report.coreWebVitals.FID < 100) {
            this.logTest('Core Web Vitals', `FID: ${Math.round(report.coreWebVitals.FID)}ms`, 'pass', container);
          }
          
          if (report.coreWebVitals.CLS && report.coreWebVitals.CLS < 0.1) {
            this.logTest('Core Web Vitals', `CLS: ${report.coreWebVitals.CLS.toFixed(3)}`, 'pass', container);
          }
        }
      }
      
      async testAccessibilityCompliance() {
        const container = document.getElementById('accessibility-tests');
        this.logTest('Accessibility Tests', 'Testing WCAG 2.1 AA compliance...', 'info', container);
        
        // Test 1: Semantic HTML
        const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
        this.logTest('Semantic HTML', `${headings.length} heading elements found`, 
          headings.length > 0 ? 'pass' : 'warning', container);
        
        // Test 2: Alt text for images
        const images = document.querySelectorAll('img');
        const imagesWithAlt = Array.from(images).filter(img => img.alt);
        this.logTest('Image Alt Text', `${imagesWithAlt.length}/${images.length} images have alt text`, 
          images.length === 0 || imagesWithAlt.length === images.length ? 'pass' : 'warning', container);
        
        // Test 3: Form labels
        const inputs = document.querySelectorAll('input, textarea, select');
        let labeledInputs = 0;
        inputs.forEach(input => {
          const label = document.querySelector(`label[for="${input.id}"]`) || input.closest('label');
          if (label || input.getAttribute('aria-label') || input.getAttribute('aria-labelledby')) {
            labeledInputs++;
          }
        });
        this.logTest('Form Labels', `${labeledInputs}/${inputs.length} form controls have labels`, 
          inputs.length === 0 || labeledInputs === inputs.length ? 'pass' : 'warning', container);
        
        // Test 4: Color contrast (basic check)
        const styles = getComputedStyle(document.body);
        const bgColor = styles.backgroundColor;
        const textColor = styles.color;
        this.logTest('Color Contrast', `Background: ${bgColor}, Text: ${textColor}`, 'info', container);
        
        // Test 5: Keyboard navigation
        const focusableElements = document.querySelectorAll('button, input, select, textarea, a[href], [tabindex]:not([tabindex="-1"])');
        this.logTest('Keyboard Navigation', `${focusableElements.length} focusable elements found`, 
          focusableElements.length > 0 ? 'pass' : 'warning', container);
      }
      
      async testSecurityValidation() {
        const container = document.getElementById('security-tests');
        this.logTest('Security Tests', 'Testing security measures...', 'info', container);
        
        if (window.ValidationSystem) {
          const validator = new ValidationSystem();
          
          // Test XSS Prevention
          const xssInput = '<script>alert("xss")</script>';
          const cleanedXSS = validator.preventXSS(xssInput);
          this.logTest('XSS Prevention', `Script tags ${cleanedXSS.includes('<script>') ? 'NOT ' : ''}removed`, 
            !cleanedXSS.includes('<script>') ? 'pass' : 'fail', container);
          
          // Test SQL Injection Prevention
          const sqlInput = "'; DROP TABLE users; --";
          const cleanedSQL = validator.preventSQLInjection(sqlInput);
          this.logTest('SQL Injection Prevention', `SQL keywords ${cleanedSQL.includes('DROP') ? 'NOT ' : ''}removed`, 
            !cleanedSQL.includes('DROP') ? 'pass' : 'fail', container);
          
          // Test Input Sanitization
          const maliciousInput = '<img src=x onerror=alert(1)>';
          const sanitized = validator.validateAndSanitizeUserInput(maliciousInput, 'general');
          this.logTest('Input Sanitization', `Malicious input ${sanitized.includes('onerror') ? 'NOT ' : ''}sanitized`, 
            !sanitized.includes('onerror') ? 'pass' : 'fail', container);
        }
        
        // Test HTTPS (if applicable)
        this.logTest('Protocol Security', `Using ${location.protocol}`, 
          location.protocol === 'https:' ? 'pass' : 'info', container);
      }
      
      async testDataIntegrity() {
        const container = document.getElementById('data-tests');
        this.logTest('Data Tests', 'Testing data integrity and backup systems...', 'info', container);
        
        // Test localStorage functionality
        try {
          const testKey = 'integrity-test';
          const testData = { test: true, timestamp: Date.now() };
          
          localStorage.setItem(testKey, JSON.stringify(testData));
          const retrieved = JSON.parse(localStorage.getItem(testKey));
          localStorage.removeItem(testKey);
          
          this.logTest('localStorage', `Data integrity ${retrieved.test === testData.test ? 'maintained' : 'compromised'}`, 
            retrieved.test === testData.test ? 'pass' : 'fail', container);
        } catch (error) {
          this.logTest('localStorage', `Storage test failed: ${error.message}`, 'fail', container);
        }
        
        // Test backup functionality
        if (window.BackupManager) {
          try {
            const backupManager = new BackupManager();
            const backupId = backupManager.createBackup();
            this.logTest('Backup System', `Backup created with ID: ${backupId}`, 'pass', container);
            
            const isValid = backupManager.verifyBackup(backupId);
            this.logTest('Backup Verification', `Backup ${isValid ? 'valid' : 'invalid'}`, 
              isValid ? 'pass' : 'fail', container);
          } catch (error) {
            this.logTest('Backup System', `Backup test failed: ${error.message}`, 'fail', container);
          }
        }
        
        // Test data export
        if (window.DataExporter) {
          try {
            const exporter = new DataExporter();
            const exportData = exporter.exportAllData();
            this.logTest('Data Export', `Export contains ${Object.keys(exportData).length} data types`, 
              Object.keys(exportData).length > 0 ? 'pass' : 'warning', container);
          } catch (error) {
            this.logTest('Data Export', `Export test failed: ${error.message}`, 'fail', container);
          }
        }
      }
      
      async testUserWorkflows() {
        const container = document.getElementById('workflow-tests');
        this.logTest('Workflow Tests', 'Testing complete user workflows...', 'info', container);
        
        // Test 1: Profile Management Workflow
        if (window.ProfileManager) {
          try {
            const profileManager = new ProfileManager();
            
            // Create test profile
            const testProfile = {
              name: 'Test User',
              email: 'test@example.com',
              preferences: { theme: 'dark' }
            };
            
            profileManager.updateProfile(testProfile);
            const savedProfile = profileManager.getCurrentProfile();
            
            this.logTest('Profile Workflow', `Profile ${savedProfile.name === testProfile.name ? 'saved and retrieved' : 'not properly saved'}`, 
              savedProfile.name === testProfile.name ? 'pass' : 'fail', container);
          } catch (error) {
            this.logTest('Profile Workflow', `Profile test failed: ${error.message}`, 'fail', container);
          }
        }
        
        // Test 2: Study Tools Workflow
        if (window.PomodoroTimer) {
          try {
            const timer = new PomodoroTimer();
            timer.start();
            
            setTimeout(() => {
              const state = timer.getState();
              this.logTest('Study Tools Workflow', `Timer ${state.isRunning ? 'running' : 'not running'}`, 
                state.isRunning ? 'pass' : 'fail', container);
              timer.pause();
            }, 100);
          } catch (error) {
            this.logTest('Study Tools Workflow', `Timer test failed: ${error.message}`, 'fail', container);
          }
        }
        
        // Test 3: Note Management Workflow
        if (window.EnhancedNoteManager) {
          try {
            const noteManager = new EnhancedNoteManager();
            
            const testNote = noteManager.createNote({
              title: 'Test Note',
              content: 'Test content',
              subject: 'Testing'
            });
            
            this.logTest('Note Management Workflow', `Note ${testNote ? 'created successfully' : 'creation failed'}`, 
              testNote ? 'pass' : 'fail', container);
          } catch (error) {
            this.logTest('Note Management Workflow', `Note test failed: ${error.message}`, 'fail', container);
          }
        }
        
        // Test 4: Bookmark Management Workflow
        if (window.EnhancedBookmarkManager) {
          try {
            const bookmarkManager = new EnhancedBookmarkManager();
            
            const testBookmark = bookmarkManager.addBookmark({
              title: 'Test Bookmark',
              url: 'https://example.com',
              category: 'general'
            });
            
            this.logTest('Bookmark Management Workflow', `Bookmark ${testBookmark ? 'created successfully' : 'creation failed'}`, 
              testBookmark ? 'pass' : 'fail', container);
          } catch (error) {
            this.logTest('Bookmark Management Workflow', `Bookmark test failed: ${error.message}`, 'fail', container);
          }
        }
      }
      
      generateFinalReport() {
        const container = document.getElementById('final-report');
        const endTime = performance.now();
        const totalDuration = endTime - this.startTime;
        const successRate = this.totalTests > 0 ? (this.passedTests / this.totalTests) * 100 : 0;
        
        const report = {
          timestamp: new Date().toISOString(),
          duration: Math.round(totalDuration),
          totalTests: this.totalTests,
          passedTests: this.passedTests,
          failedTests: this.failedTests,
          successRate: successRate.toFixed(1),
          results: Object.fromEntries(this.testResults),
          browserInfo: {
            userAgent: navigator.userAgent,
            platform: navigator.platform,
            language: navigator.language,
            cookieEnabled: navigator.cookieEnabled,
            onLine: navigator.onLine
          },
          performanceInfo: performance.memory ? {
            usedJSHeapSize: Math.round(performance.memory.usedJSHeapSize / 1024 / 1024),
            totalJSHeapSize: Math.round(performance.memory.totalJSHeapSize / 1024 / 1024),
            jsHeapSizeLimit: Math.round(performance.memory.jsHeapSizeLimit / 1024 / 1024)
          } : null
        };
        
        let reportHtml = `
          <div class="bg-gradient-to-r from-gray-800 to-gray-900 p-6 rounded-lg">
            <h3 class="text-xl font-semibold mb-4">Test Execution Summary</h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
              <div class="text-center">
                <div class="text-2xl font-bold text-blue-400">${report.totalTests}</div>
                <div class="text-sm text-gray-400">Total Tests</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-green-400">${report.passedTests}</div>
                <div class="text-sm text-gray-400">Passed</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-red-400">${report.failedTests}</div>
                <div class="text-sm text-gray-400">Failed</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-teal-400">${report.successRate}%</div>
                <div class="text-sm text-gray-400">Success Rate</div>
              </div>
            </div>
            
            <div class="mb-4">
              <strong>Duration:</strong> ${report.duration}ms<br>
              <strong>Browser:</strong> ${navigator.userAgent.split(' ').slice(-2).join(' ')}<br>
              <strong>Platform:</strong> ${navigator.platform}
            </div>
        `;
        
        if (report.performanceInfo) {
          reportHtml += `
            <div class="mb-4">
              <strong>Memory Usage:</strong> ${report.performanceInfo.usedJSHeapSize}MB / ${report.performanceInfo.totalJSHeapSize}MB
            </div>
          `;
        }
        
        // Overall assessment
        let assessment = '';
        let assessmentClass = '';
        
        if (successRate >= 95) {
          assessment = 'üéâ Excellent! The platform is production-ready with outstanding quality.';
          assessmentClass = 'text-green-400';
        } else if (successRate >= 85) {
          assessment = '‚úÖ Good! The platform is ready for production with minor issues to address.';
          assessmentClass = 'text-blue-400';
        } else if (successRate >= 70) {
          assessment = '‚ö†Ô∏è Acceptable! Some issues need to be resolved before production deployment.';
          assessmentClass = 'text-yellow-400';
        } else {
          assessment = '‚ùå Critical issues detected! Significant work needed before production.';
          assessmentClass = 'text-red-400';
        }
        
        reportHtml += `
            <div class="mt-6 p-4 bg-gray-800 rounded-lg">
              <h4 class="font-semibold mb-2">Overall Assessment:</h4>
              <p class="${assessmentClass} text-lg">${assessment}</p>
            </div>
          </div>
        `;
        
        container.innerHTML = reportHtml;
        
        // Store report for export
        this.finalReport = report;
        
        // Update final progress
        this.updateProgress();
        
        // Setup export functionality
        document.getElementById('export-report').addEventListener('click', () => {
          this.exportReport();
        });
      }
      
      exportReport() {
        const reportData = JSON.stringify(this.finalReport, null, 2);
        const blob = new Blob([reportData], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = `qa-test-report-${new Date().toISOString().split('T')[0]}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }
      
      logTest(category, message, type, container) {
        this.totalTests++;
        
        if (type === 'pass') {
          this.passedTests++;
        } else if (type === 'fail') {
          this.failedTests++;
        }
        
        this.testResults.set(`${category}: ${message}`, {
          type,
          timestamp: new Date().toISOString()
        });
        
        if (container) {
          const div = document.createElement('div');
          div.className = `test-result test-${type}`;
          
          const icon = type === 'pass' ? '‚úÖ' : type === 'fail' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
          div.innerHTML = `${icon} <strong>[${category}]</strong> ${message}`;
          
          if (typeof container === 'string') {
            document.getElementById(container).appendChild(div);
          } else {
            container.appendChild(div);
          }
        }
        
        this.updateProgress();
      }
      
      updateProgress() {
        const percentage = this.totalTests > 0 ? ((this.passedTests + this.failedTests) / this.totalTests) * 100 : 0;
        const successRate = this.totalTests > 0 ? (this.passedTests / this.totalTests) * 100 : 0;
        
        document.getElementById('overall-progress').style.width = percentage + '%';
        document.getElementById('progress-text').textContent = 
          `${this.passedTests + this.failedTests}/${this.totalTests} tests completed`;
        
        document.getElementById('total-tests').textContent = this.totalTests;
        document.getElementById('passed-tests').textContent = this.passedTests;
        document.getElementById('failed-tests').textContent = this.failedTests;
        document.getElementById('success-rate').textContent = successRate.toFixed(1) + '%';
      }
    }
    
    // Initialize test suite when page loads
    document.addEventListener('DOMContentLoaded', () => {
      if (window.lucide) {
        window.lucide.createIcons();
      }
      
      setTimeout(() => {
        new ComprehensiveTestSuite();
      }, 1000);
    });
  </script>
</body>
</html>