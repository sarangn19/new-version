/**
 * Mock AI Responses for Testing
 * Provides realistic responses while API issues are being resolved
 */
class MockAIResponses {
    constructor() {
        this.responses = {
            general: [
                "DEFINITION:\nThe Indian Constitution is the supreme law of India that establishes the framework of government, fundamental rights, and directive principles. It serves as the foundational document for India's democratic governance.\n\nKEY FEATURES:\n• Adopted on 26th January 1950 (Republic Day)\n• World's longest written constitution with 395 articles and 12 schedules\n• Establishes parliamentary democracy with federal structure\n• Incorporates fundamental rights, duties, and directive principles\n• Provides for independent judiciary with judicial review\n• Ensures separation of powers between legislature, executive, and judiciary\n\nUPSC RELEVANCE:\n• Core topic for General Studies Paper 2 (Polity)\n• Frequently appears in both Prelims and Mains examinations\n• Foundation for understanding Indian governance and administration\n• Essential for current affairs analysis and policy understanding\n\nSTUDY APPROACH:\n• Focus on constitutional provisions and their practical applications\n• Understand landmark judgments and constitutional amendments\n• Connect with current political and administrative developments\n• Practice previous year questions for better preparation",
                "CONCEPT EXPLANATION:\nThis topic requires understanding both theoretical framework and practical applications for UPSC success.\n\nSTUDY APPROACH:\n• Learn the basic definition first\n• Understand historical context\n• Connect with current affairs\n• Practice previous year questions\n\nEXAM STRATEGY:\n• Focus on factual accuracy for Prelims\n• Develop analytical skills for Mains\n• Use examples and case studies",
                "UPSC PERSPECTIVE:\nThis concept is crucial for Civil Services preparation and appears regularly in examinations.\n\nIMPORTANT ASPECTS:\n• Constitutional provisions\n• Historical evolution\n• Current applications\n• Recent developments\n\nPREPARATION TIPS:\n• Make concise notes\n• Create mind maps\n• Regular revision essential\n• Connect with other topics"
            ],
            mcq: [
                "MCQ ANALYSIS:\n\nQUESTION BREAKDOWN:\nThis question tests your understanding of constitutional provisions and their applications.\n\nOPTION ANALYSIS:\nA) Incorrect - This option misrepresents the constitutional provision\nB) Correct - Aligns with Article provisions and established precedents\nC) Incorrect - Common misconception, confuses similar concepts\nD) Incorrect - Factually wrong interpretation\n\nCORRECT ANSWER: Option B\n\nKEY LEARNING:\n• Constitutional articles have specific exceptions\n• Always read options carefully\n• Eliminate obviously wrong answers first\n\nEXAM STRATEGY:\n• Focus on keywords in questions\n• Avoid absolute terms like 'always' or 'never'\n• Practice similar questions for better understanding",
                "MCQ SOLUTION:\n\nCONCEPT TESTED:\nFundamental principle of constitutional law and its practical applications.\n\nSTEP-BY-STEP APPROACH:\n1. Identify the core concept being tested\n2. Recall relevant constitutional provisions\n3. Eliminate incorrect options systematically\n4. Select the most accurate answer\n\nCORRECT APPROACH:\nThe right answer focuses on established constitutional principles rather than exceptions.\n\nCOMMON MISTAKES:\n• Confusing similar constitutional provisions\n• Not reading options completely\n• Falling for distractors\n\nPRELIMS TIP:\nThis question type appears frequently in UPSC Prelims. Focus on factual accuracy."
            ],
            essay: [
                "ESSAY EVALUATION:\n\nSTRENGTHS IDENTIFIED:\n• Clear introduction with proper context setting\n• Good use of relevant examples and case studies\n• Logical flow and coherent argument structure\n• Appropriate use of technical terminology\n\nAREAS FOR IMPROVEMENT:\n• Include more recent government initiatives\n• Add statistical data to support arguments\n• Strengthen conclusion with actionable recommendations\n• Balance different perspectives on the issue\n\nUPSC MAINS STRATEGY:\n• Maintain 1000-word limit strictly\n• Use subheadings for better organization\n• Include committee reports and policy references\n• Demonstrate multi-dimensional thinking\n\nSCORING TIPS:\n• Content accuracy and relevance (40%)\n• Analytical depth and critical thinking (30%)\n• Structure and presentation (20%)\n• Language and expression (10%)",
                "ESSAY FEEDBACK:\n\nCONTENT ANALYSIS:\n• Demonstrates good conceptual understanding\n• Relevant examples show practical knowledge\n• Arguments are well-supported with evidence\n\nSTRUCTURAL ASSESSMENT:\n• Introduction effectively sets the context\n• Body paragraphs maintain logical progression\n• Conclusion needs stronger policy recommendations\n\nENHANCEMENT SUGGESTIONS:\n• Add more contemporary examples\n• Include international best practices\n• Ensure balanced argumentation throughout\n• Use more data and statistics\n\nMAINS PREPARATION:\n• Practice time management (45 minutes per essay)\n• Develop diverse examples bank\n• Focus on analytical rather than descriptive writing\n• Regular practice with feedback essential"
            ],
            mcq_generator: [
                "MCQ QUESTIONS GENERATED:\n\nQUESTION 1:\nWhich of the following is NOT a fundamental right under the Indian Constitution?\nA) Right to Equality\nB) Right to Property\nC) Right to Freedom of Religion\nD) Right to Constitutional Remedies\n\nCORRECT ANSWER: B) Right to Property\nEXPLANATION: Right to Property was removed as a fundamental right by the 44th Amendment in 1978. It is now a constitutional right under Article 300A.\n\nQUESTION 2:\nThe concept of 'Basic Structure' of the Constitution was established in which landmark case?\nA) Golaknath Case\nB) Kesavananda Bharati Case\nC) Minerva Mills Case\nD) Maneka Gandhi Case\n\nCORRECT ANSWER: B) Kesavananda Bharati Case\nEXPLANATION: The Supreme Court established the Basic Structure doctrine in Kesavananda Bharati v. State of Kerala (1973), limiting Parliament's power to amend the Constitution.\n\nQUESTION 3:\nWhich article of the Constitution deals with the Right to Education?\nA) Article 19\nB) Article 21\nC) Article 21A\nD) Article 25\n\nCORRECT ANSWER: C) Article 21A\nEXPLANATION: Article 21A was inserted by the 86th Amendment Act, 2002, making free and compulsory education a fundamental right for children aged 6-14 years.\n\nSTUDY TIPS:\n• Practice these MCQs regularly for better retention\n• Understand the reasoning behind each correct answer\n• Connect constitutional provisions with landmark cases\n• Review related amendments and their historical context"
            ],
            
            flashcard_generator: [
                "FLASHCARDS CREATED:\n\nFLASHCARD 1:\nFRONT: What is the Basic Structure Doctrine?\nBACK: A judicial principle established in Kesavananda Bharati case (1973) that certain features of the Constitution are so fundamental that they cannot be amended by Parliament. Key elements include: supremacy of Constitution, rule of law, independence of judiciary, federalism, secularism, and separation of powers.\n\nFLASHCARD 2:\nFRONT: List the six Fundamental Rights with Articles\nBACK: 1) Right to Equality (Articles 14-18) - includes equality before law, prohibition of discrimination; 2) Right to Freedom (Articles 19-22) - includes freedom of speech, assembly, movement; 3) Right against Exploitation (Articles 23-24) - prohibits trafficking and child labor; 4) Right to Freedom of Religion (Articles 25-28) - freedom of conscience and religion; 5) Cultural & Educational Rights (Articles 29-30) - protection of minorities; 6) Right to Constitutional Remedies (Article 32) - right to approach Supreme Court directly.\n\nFLASHCARD 3:\nFRONT: What is Article 356 and its conditions?\nBACK: President's Rule - Allows Union government to take direct control of state administration when constitutional machinery fails. Conditions: Governor's report or satisfaction of President that state government cannot function according to Constitution. Duration: Initially 6 months, extendable to 1 year with Parliament approval, maximum 3 years with constitutional amendment. Also called State Emergency.\n\nSTUDY INSTRUCTIONS:\n• Review these flashcards daily using spaced repetition\n• Test yourself by reading the front and recalling the back\n• Focus on understanding concepts and their interconnections\n• Practice writing key points from memory for Mains preparation"
            ],
            
            answer_evaluation: [
                "ANSWER EVALUATION:\n\nSTRUCTURE ANALYSIS:\n• Introduction: Well-structured with clear context\n• Body: Logical flow of arguments present\n• Conclusion: Needs strengthening with actionable suggestions\n\nCONTENT ASSESSMENT:\n• Factual Accuracy: 85% - Most facts are correct\n• Conceptual Understanding: Good grasp of core concepts\n• Examples Used: Relevant but could be more recent\n• Data/Statistics: Limited use, add more quantitative support\n\nWRITING QUALITY:\n• Language: Clear and appropriate for UPSC\n• Expression: Good but can be more concise\n• Word Limit: Within prescribed limits\n• Presentation: Neat and organized\n\nSCORE BREAKDOWN:\n• Content (40%): 32/40\n• Structure (25%): 20/25\n• Expression (20%): 16/20\n• Presentation (15%): 12/15\n\nTOTAL SCORE: 80/100\n\nIMPROVEMENT SUGGESTIONS:\n• Add more recent examples and case studies\n• Include statistical data to support arguments\n• Strengthen conclusion with policy recommendations\n• Practice time management for better coverage"
            ],
            
            news: [
                "NEWS ANALYSIS FOR UPSC:\n\nSYLLABUS RELEVANCE:\n• General Studies Paper 2: Governance and Constitutional issues\n• General Studies Paper 3: Economic development and policy\n• Potential essay topic for Mains examination\n\nKEY UPSC ANGLES:\n• Constitutional implications and legal framework\n• Policy connections with existing government schemes\n• International relations and diplomatic aspects\n• Social and economic impact assessment\n\nEXAM PREPARATION:\nPrelims Focus:\n• Important facts, figures, and dates\n• Key stakeholders and institutions involved\n• Government schemes and policy initiatives\n\nMains Application:\n• Multi-dimensional analysis required\n• Connect with broader policy framework\n• Discuss challenges and way forward\n\nSTUDY STRATEGY:\n• Make concise notes with key points\n• Track follow-up developments\n• Connect with related syllabus topics",
                "CURRENT AFFAIRS ANALYSIS:\n\nUPSC IMPORTANCE:\nThis development has direct relevance for Civil Services examination across multiple papers.\n\nSYLLABUS MAPPING:\n• GS Paper 1: Social issues and governance\n• GS Paper 2: Constitutional and policy matters\n• GS Paper 3: Economic implications\n• Essay Paper: Potential topic for discussion\n\nCRITICAL ASPECTS:\n• Government policy response and implementation\n• Stakeholder perspectives and challenges\n• Long-term socio-economic implications\n• International best practices and comparisons\n\nPREPARATION APPROACH:\n• Understand the complete policy framework\n• Note important statistics and data\n• Practice answer writing on related themes\n• Connect with previous year questions\n\nEXAM STRATEGY:\n• Focus on factual accuracy for Prelims\n• Develop analytical perspective for Mains\n• Prepare diverse examples for essay writing"
            ]
        };
        
        this.contextualResponses = {
            "constitution": "INDIAN CONSTITUTION:\n\nDEFINITION:\nSupreme law of India that establishes the framework of government, fundamental rights, and directive principles.\n\nKEY FEATURES:\n• Longest written constitution in the world\n• Parliamentary system of government\n• Federal structure with unitary bias\n• Fundamental rights and duties\n• Independent judiciary with judicial review\n\nUPSC RELEVANCE:\n• Core topic for Polity section\n• Frequently asked in both Prelims and Mains\n• Foundation for understanding governance\n\nIMPORTANT ARTICLES:\n• Article 1: Name and territory of Union\n• Article 12-35: Fundamental Rights\n• Article 36-51: Directive Principles",
            "federalism": "INDIAN FEDERALISM:\n\nCONCEPT:\nIndia follows a quasi-federal structure with both federal and unitary features.\n\nFEDERAL FEATURES:\n• Written Constitution\n• Division of powers between Centre and States\n• Independent judiciary\n• Bicameral legislature\n\nUNITARY FEATURES:\n• Single Constitution for Centre and States\n• Appointment of Governor by Centre\n• Emergency provisions\n• Single citizenship\n\nUPSC PERSPECTIVE:\n• Important for Constitutional Law questions\n• Frequently appears in Prelims and Mains\n• Connect with Centre-State relations\n\nEXAM TIP:\nUnderstand the balance between federal and unitary features for comprehensive answers.",
            "fundamental rights": "FUNDAMENTAL RIGHTS:\n\nDEFINITION:\nBasic human rights guaranteed to all citizens under Articles 12-35 of the Constitution.\n\nSIX CATEGORIES:\n• Right to Equality (Articles 14-18)\n• Right to Freedom (Articles 19-22)\n• Right against Exploitation (Articles 23-24)\n• Right to Freedom of Religion (Articles 25-28)\n• Cultural and Educational Rights (Articles 29-30)\n• Right to Constitutional Remedies (Article 32)\n\nKEY FEATURES:\n• Justiciable rights enforceable by courts\n• Not absolute - subject to reasonable restrictions\n• Can be suspended during emergency\n• Article 32 called 'Heart and Soul' of Constitution\n\nUPSC IMPORTANCE:\n• Core topic for Polity preparation\n• Frequently tested in both papers\n• Connect with landmark judgments",
            "upsc": "The Union Public Service Commission conducts the Civil Services Examination, which is considered one of India's most prestigious competitive exams for administrative services.",
            "current affairs": "Current affairs form a crucial part of UPSC preparation. Stay updated with government policies, international relations, economic developments, and social issues.",
            "prelims": "UPSC Prelims consists of two objective papers - General Studies and CSAT. Focus on factual accuracy, current events, and analytical thinking.",
            "mains": "UPSC Mains has 9 papers including Essay, General Studies (4 papers), Optional subject (2 papers), and language papers. Emphasis is on analytical and writing skills."
        };
    }
    
    /**
     * Generate mock response based on input and mode
     * @param {string} input - User input
     * @param {string} mode - AI mode (general, mcq, essay, news)
     * @returns {Object} Mock response object
     */
    generateResponse(input, mode = 'general') {
        const startTime = Date.now();
        
        // Simulate processing delay
        const processingTime = Math.random() * 500 + 200; // 200-700ms
        
        let responseText = this.getContextualResponse(input, mode);
        
        // If no contextual response found, use random response from mode
        if (!responseText) {
            const modeResponses = this.responses[mode] || this.responses.general;
            responseText = modeResponses[Math.floor(Math.random() * modeResponses.length)];
        }
        
        return {
            id: `mock_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
            content: responseText,
            mode: mode,
            timestamp: new Date().toISOString(),
            processingTime: Math.round(processingTime),
            usage: {
                promptTokenCount: Math.floor(input.length / 4),
                candidatesTokenCount: Math.floor(responseText.length / 4),
                totalTokenCount: Math.floor((input.length + responseText.length) / 4)
            },
            fromCache: false,
            isMock: true
        };
    }
    
    /**
     * Get contextual response based on keywords in input
     * @param {string} input - User input
     * @param {string} mode - AI mode
     * @returns {string|null} Contextual response or null
     */
    getContextualResponse(input, mode) {
        const lowerInput = input.toLowerCase();
        
        // Check for specific keywords
        for (const [keyword, response] of Object.entries(this.contextualResponses)) {
            if (lowerInput.includes(keyword)) {
                return this.enhanceResponseForMode(response, mode);
            }
        }
        
        // Check for question patterns
        if (mode === 'mcq_generator' || mode === 'mcq') {
            return this.generateMCQsResponse(input);
        }
        
        if (mode === 'flashcard_generator' || mode === 'flashcard') {
            return this.generateFlashcardsResponse(input);
        }
        
        if (mode === 'answer_evaluation') {
            return this.generateAnswerEvaluationResponse(input);
        }
        
        if (lowerInput.includes('explain') || lowerInput.includes('what is')) {
            return this.generateExplanationResponse(input, mode);
        }
        
        if (lowerInput.includes('mcq') || lowerInput.includes('multiple choice')) {
            return this.generateMCQResponse(input);
        }
        
        if (lowerInput.includes('essay') || lowerInput.includes('write about')) {
            return this.generateEssayResponse(input);
        }
        
        if (lowerInput.includes('news') || lowerInput.includes('current')) {
            return this.generateNewsResponse(input);
        }
        
        return null;
    }
    
    /**
     * Enhance response based on mode
     * @param {string} baseResponse - Base response text
     * @param {string} mode - AI mode
     * @returns {string} Enhanced response
     */
    enhanceResponseForMode(baseResponse, mode) {
        switch (mode) {
            case 'mcq':
                return `${baseResponse}\n\n**For MCQ Practice**: This concept often appears in UPSC Prelims. Focus on factual accuracy and recent developments.`;
            case 'essay':
                return `${baseResponse}\n\n**For Essay Writing**: This topic can be approached from multiple angles - historical, contemporary, and futuristic perspectives.`;
            case 'news':
                return `${baseResponse}\n\n**Current Relevance**: Stay updated with recent government policies and Supreme Court judgments related to this topic.`;
            default:
                return baseResponse;
        }
    }
    
    /**
     * Generate explanation response
     * @param {string} input - User input
     * @param {string} mode - AI mode
     * @returns {string} Explanation response
     */
    generateExplanationResponse(input, mode) {
        return `I'll explain this concept for your UPSC preparation:\n\n**Definition**: This is a fundamental concept in the UPSC syllabus.\n\n**Key Points**:\n- Historical background and evolution\n- Constitutional provisions and legal framework\n- Current applications and relevance\n\n**UPSC Perspective**: This topic is important for both Prelims and Mains. Focus on understanding the practical implications and recent developments.\n\n**Study Tip**: Connect this concept with related topics and practice previous year questions.`;
    }
    
    /**
     * Generate MCQ analysis response
     * @param {string} input - User input
     * @returns {string} MCQ analysis response
     */
    generateMCQResponse(input) {
        return `Let me help you analyze this MCQ:\n\n**Step-by-Step Analysis**:\n\n1. **Question Analysis**: Understanding what the question is asking\n2. **Option Evaluation**: Examining each option carefully\n3. **Elimination Strategy**: Removing obviously incorrect options\n4. **Final Selection**: Choosing the most accurate answer\n\n**UPSC MCQ Tips**:\n- Read questions carefully, noting keywords\n- Look for absolute terms that are usually incorrect\n- Use elimination method when unsure\n- Practice time management\n\n**Related Topics**: Make sure to study connected concepts for comprehensive understanding.`;
    }
    
    /**
     * Generate essay feedback response
     * @param {string} input - User input
     * @returns {string} Essay feedback response
     */
    generateEssayResponse(input) {
        return `Here's my feedback on your essay approach:\n\n**Structure Suggestions**:\n- **Introduction**: Set the context and define key terms\n- **Body**: Multi-dimensional analysis with examples\n- **Conclusion**: Balanced view with way forward\n\n**Content Enhancement**:\n- Include recent data and statistics\n- Reference government policies and schemes\n- Add international comparisons where relevant\n- Maintain analytical and balanced tone\n\n**UPSC Mains Strategy**:\n- Stick to word limits (250/1000 words)\n- Use diagrams and flowcharts where appropriate\n- Practice time management (30-45 minutes per essay)\n\n**Improvement Areas**: Focus on clarity, coherence, and comprehensive coverage of the topic.`;
    }
    
    /**
     * Generate MCQs response
     * @param {string} input - User input
     * @returns {string} MCQs response
     */
    generateMCQsResponse(input) {
        const topic = input.replace(/generate|mcq|questions|for|about|on/gi, '').trim() || 'Constitutional Law';
        const quantity = window.selectedQuantity || 3;
        
        let response = `MCQ QUESTIONS ON ${topic.toUpperCase()}:\n\n`;
        
        for (let i = 1; i <= quantity; i++) {
            response += `QUESTION ${i}:\n`;
            response += `Which of the following statements about ${topic} is correct?\n`;
            response += `A) Statement A about the topic\n`;
            response += `B) Statement B about the topic\n`;
            response += `C) Statement C about the topic\n`;
            response += `D) Statement D about the topic\n\n`;
            response += `CORRECT ANSWER: B\n`;
            response += `EXPLANATION: This option correctly represents the key concept of ${topic} as per UPSC syllabus.\n\n`;
        }
        
        response += `STUDY TIPS:\n`;
        response += `• Practice these questions multiple times\n`;
        response += `• Understand the reasoning behind each answer\n`;
        response += `• Connect with related topics in syllabus\n`;
        response += `• Review explanations for better conceptual clarity`;
        
        return response;
    }

    /**
     * Generate flashcards response
     * @param {string} input - User input
     * @returns {string} Flashcards response
     */
    generateFlashcardsResponse(input) {
        const topic = input.replace(/create|make|flashcard|flashcards|for|about|on/gi, '').trim() || 'Indian Constitution';
        const quantity = window.selectedQuantity || 3;
        
        let response = `FLASHCARDS FOR ${topic.toUpperCase()}:\n\n`;
        
        for (let i = 1; i <= quantity; i++) {
            response += `FLASHCARD ${i}:\n`;
            response += `FRONT: Key concept ${i} of ${topic}\n`;
            response += `BACK: Detailed explanation of the concept with relevant articles, amendments, and UPSC significance. Include examples and recent developments.\n\n`;
        }
        
        response += `USAGE INSTRUCTIONS:\n`;
        response += `• Review flashcards daily for 10-15 minutes\n`;
        response += `• Test yourself by reading the front and recalling the back\n`;
        response += `• Mark difficult cards for extra practice\n`;
        response += `• Connect flashcards with previous year questions\n`;
        response += `• Use spaced repetition for better retention`;
        
        return response;
    }

    /**
     * Generate answer evaluation response
     * @param {string} input - User input
     * @returns {string} Answer evaluation response
     */
    generateAnswerEvaluationResponse(input) {
        return `ANSWER EVALUATION REPORT:\n\nIMAGE ANALYSIS:\n• Handwriting: Clear and legible\n• Structure: Well-organized with proper paragraphs\n• Length: Appropriate for the question type\n• Presentation: Neat with good spacing\n\nCONTENT EVALUATION:\n• Introduction: Sets context effectively\n• Main Body: Covers key points systematically\n• Arguments: Logical flow with supporting evidence\n• Conclusion: Summarizes well with way forward\n\nSTRENGTHS:\n• Good conceptual understanding\n• Relevant examples used\n• Proper UPSC answer format\n• Time management appears adequate\n\nAREAS FOR IMPROVEMENT:\n• Add more recent data and statistics\n• Include diverse perspectives\n• Strengthen analytical component\n• Better integration of examples\n\nSCORE ASSESSMENT:\n• Content Knowledge: 35/40\n• Structure & Presentation: 22/25\n• Analysis & Evaluation: 28/35\n\nOVERALL SCORE: 85/100\n\nRECOMMendations:\n• Practice more analytical questions\n• Build a repository of recent examples\n• Focus on multi-dimensional analysis\n• Regular answer writing practice essential`;
    }

    /**
     * Generate news analysis response
     * @param {string} input - User input
     * @returns {string} News analysis response
     */
    generateNewsResponse(input) {
        return `Here's the UPSC analysis of this news item:\n\n**Syllabus Relevance**:\n- General Studies Paper: [Relevant paper based on topic]\n- Optional Subject: [If applicable]\n- Essay Paper: [Potential essay angles]\n\n**Key Learning Points**:\n- Policy implications and government response\n- Stakeholder perspectives and challenges\n- Long-term consequences and solutions\n\n**Exam Preparation**:\n- **Prelims**: Focus on facts, figures, and recent developments\n- **Mains**: Analyze causes, effects, and policy recommendations\n- **Interview**: Understand multiple viewpoints and current debates\n\n**Follow-up Study**: Track related developments and connect with broader themes in the syllabus.`;
    }
}

// Export for use in other modules
if (typeof module !== 'undefined' && module.exports) {
    module.exports = MockAIResponses;
} else if (typeof window !== 'undefined') {
    window.MockAIResponses = MockAIResponses;
}