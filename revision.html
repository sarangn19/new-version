<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Revision - UPSC Prep</title>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link rel="stylesheet" href="styles/glassmorphism.css">
    <link rel="stylesheet" href="styles/duolingo-animations.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .revision-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .last-updated {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 20px;
        }

        .performance-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .revision-sections {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .section h2 {
            color: white;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .priority-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .priority-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .priority-high { border-left-color: #ff4757; }
        .priority-medium { border-left-color: #ffa502; }
        .priority-low { border-left-color: #2ed573; }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .item-title {
            color: white;
            font-weight: 600;
            flex: 1;
        }

        .item-score {
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            color: white;
        }

        .item-details {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            gap: 15px;
        }

        .study-plan {
            grid-column: 1 / -1;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .plan-timeline {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .day-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            color: white;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .day-card.today {
            border-color: #ffa502;
            background: rgba(255, 165, 2, 0.2);
        }

        .day-card:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .day-name {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .day-topics {
            font-size: 0.75rem;
            line-height: 1.3;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .progress-ring {
            width: 60px;
            height: 60px;
            margin: 0 auto 10px;
        }

        .progress-ring circle {
            fill: none;
            stroke-width: 4;
            stroke-linecap: round;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        .progress-bg {
            stroke: rgba(255, 255, 255, 0.2);
        }

        .progress-fill {
            stroke: #2ed573;
            stroke-dasharray: 157;
            stroke-dashoffset: 157;
            transition: stroke-dashoffset 1s ease;
        }

        @media (max-width: 768px) {
            .revision-sections {
                grid-template-columns: 1fr;
            }
            
            .plan-timeline {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>

<body>
    <div class="revision-container">
        <div class="header">
            <h1>üéØ Smart Revision Dashboard</h1>
            <div class="last-updated">Last updated: <span id="lastUpdated">Today, 6:00 AM</span></div>
        </div>

        <div class="performance-overview">
            <div class="stat-card">
                <div class="progress-ring">
                    <svg width="60" height="60">
                        <circle class="progress-bg" cx="30" cy="30" r="25"></circle>
                        <circle class="progress-fill" cx="30" cy="30" r="25" id="overallProgress"></circle>
                    </svg>
                </div>
                <div class="stat-value" id="overallScore">78%</div>
                <div class="stat-label">Overall Performance</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-value" id="weakTopics">12</div>
                <div class="stat-label">Topics Need Attention</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-value" id="studyStreak">7</div>
                <div class="stat-label">Day Study Streak</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-value" id="todayTarget">4/6</div>
                <div class="stat-label">Today's Target</div>
            </div>
        </div>

        <div class="revision-sections">
            <div class="section">
                <h2>
                    <i data-lucide="alert-triangle"></i>
                    Priority Topics
                </h2>
                
                <div class="priority-item priority-high" onclick="startRevision('polity-fundamental-rights')">
                    <div class="item-header">
                        <div class="item-title">Fundamental Rights</div>
                        <div class="item-score">45%</div>
                    </div>
                    <div class="item-details">
                        <span>üìö Polity</span>
                        <span>‚è∞ Last studied: 5 days ago</span>
                    </div>
                </div>

                <div class="priority-item priority-high" onclick="startRevision('geography-climate')">
                    <div class="item-header">
                        <div class="item-title">Climate & Weather</div>
                        <div class="item-score">52%</div>
                    </div>
                    <div class="item-details">
                        <span>üåç Geography</span>
                        <span>‚è∞ Last studied: 3 days ago</span>
                    </div>
                </div>

                <div class="priority-item priority-medium" onclick="startRevision('history-medieval')">
                    <div class="item-header">
                        <div class="item-title">Medieval History</div>
                        <div class="item-score">68%</div>
                    </div>
                    <div class="item-details">
                        <span>üèõÔ∏è History</span>
                        <span>‚è∞ Last studied: 2 days ago</span>
                    </div>
                </div>

                <div class="priority-item priority-low" onclick="startRevision('economics-budget')">
                    <div class="item-header">
                        <div class="item-title">Union Budget</div>
                        <div class="item-score">82%</div>
                    </div>
                    <div class="item-details">
                        <span>üí∞ Economics</span>
                        <span>‚è∞ Last studied: 1 day ago</span>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>
                    <i data-lucide="trending-up"></i>
                    Recommended Today
                </h2>
                
                <div class="priority-item priority-medium" onclick="startRevision('current-affairs-recent')">
                    <div class="item-header">
                        <div class="item-title">Recent Current Affairs</div>
                        <div class="item-score">New</div>
                    </div>
                    <div class="item-details">
                        <span>üì∞ Current Affairs</span>
                        <span>üî• Trending topics</span>
                    </div>
                </div>

                <div class="priority-item priority-medium" onclick="startRevision('science-space')">
                    <div class="item-header">
                        <div class="item-title">Space Technology</div>
                        <div class="item-score">71%</div>
                    </div>
                    <div class="item-details">
                        <span>üî¨ Science</span>
                        <span>‚≠ê Spaced repetition due</span>
                    </div>
                </div>

                <div class="priority-item priority-low" onclick="startRevision('environment-biodiversity')">
                    <div class="item-header">
                        <div class="item-title">Biodiversity</div>
                        <div class="item-score">85%</div>
                    </div>
                    <div class="item-details">
                        <span>üå± Environment</span>
                        <span>üîÑ Quick review</span>
                    </div>
                </div>

                <div class="priority-item priority-high" onclick="startRevision('ethics-case-studies')">
                    <div class="item-header">
                        <div class="item-title">Ethics Case Studies</div>
                        <div class="item-score">58%</div>
                    </div>
                    <div class="item-details">
                        <span>‚öñÔ∏è Ethics</span>
                        <span>üìù Practice needed</span>
                    </div>
                </div>
            </div>

            <div class="study-plan">
                <h2>
                    <i data-lucide="calendar"></i>
                    7-Day Study Plan
                </h2>
                
                <div class="plan-timeline">
                    <div class="day-card today">
                        <div class="day-name">Today</div>
                        <div class="day-topics">
                            ‚Ä¢ Fundamental Rights<br>
                            ‚Ä¢ Climate & Weather<br>
                            ‚Ä¢ Current Affairs
                        </div>
                    </div>
                    
                    <div class="day-card">
                        <div class="day-name">Tomorrow</div>
                        <div class="day-topics">
                            ‚Ä¢ Medieval History<br>
                            ‚Ä¢ Space Technology<br>
                            ‚Ä¢ Mock Test
                        </div>
                    </div>
                    
                    <div class="day-card">
                        <div class="day-name">Day 3</div>
                        <div class="day-topics">
                            ‚Ä¢ Ethics Cases<br>
                            ‚Ä¢ Biodiversity<br>
                            ‚Ä¢ Previous Year Q
                        </div>
                    </div>
                    
                    <div class="day-card">
                        <div class="day-name">Day 4</div>
                        <div class="day-topics">
                            ‚Ä¢ Union Budget<br>
                            ‚Ä¢ Revision Test<br>
                            ‚Ä¢ Weak Topics
                        </div>
                    </div>
                    
                    <div class="day-card">
                        <div class="day-name">Day 5</div>
                        <div class="day-topics">
                            ‚Ä¢ Comprehensive<br>
                            ‚Ä¢ Review<br>
                            ‚Ä¢ Practice
                        </div>
                    </div>
                    
                    <div class="day-card">
                        <div class="day-name">Day 6</div>
                        <div class="day-topics">
                            ‚Ä¢ Full Length<br>
                            ‚Ä¢ Mock Test<br>
                            ‚Ä¢ Analysis
                        </div>
                    </div>
                    
                    <div class="day-card">
                        <div class="day-name">Day 7</div>
                        <div class="day-topics">
                            ‚Ä¢ Rest Day<br>
                            ‚Ä¢ Light Review<br>
                            ‚Ä¢ Planning
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="action-buttons">
            <button class="btn btn-primary" onclick="startSmartRevision()">
                <i data-lucide="play"></i>
                Start Smart Revision
            </button>
            <button class="btn btn-secondary" onclick="customizeStudyPlan()">
                <i data-lucide="settings"></i>
                Customize Plan
            </button>
            <button class="btn btn-secondary" onclick="viewAnalytics()">
                <i data-lucide="bar-chart-3"></i>
                View Analytics
            </button>
        </div>
    </div>

    <script src="js/revision-engine.js"></script>
    <script>
        let revisionEngine;

        // Fallback function to replace icons with text
        function replaceIconsWithText() {
            const iconMap = {
                'book-open': 'üìö',
                'layers': 'üìã',
                'refresh-cw': 'üîÑ',
                'help-circle': '‚ùì',
                'bookmark': 'üîñ',
                'user': 'üë§',
                'alert-triangle': '‚ö†Ô∏è',
                'trending-up': 'üìà',
                'calendar': 'üìÖ',
                'play': '‚ñ∂Ô∏è',
                'settings': '‚öôÔ∏è',
                'bar-chart-3': 'üìä'
            };

            document.querySelectorAll('[data-lucide]').forEach(icon => {
                const iconName = icon.getAttribute('data-lucide');
                if (iconMap[iconName]) {
                    icon.innerHTML = iconMap[iconName];
                    icon.style.fontSize = '16px';
                    icon.style.display = 'inline-block';
                    icon.style.width = '20px';
                    icon.style.height = '20px';
                    icon.style.textAlign = 'center';
                }
            });
        }

        // Initialize icons with fallback
        function initializeIcons() {
            if (typeof lucide !== 'undefined') {
                try {
                    lucide.createIcons();
                    console.log('Lucide icons loaded successfully');
                } catch (error) {
                    console.warn('Lucide icons failed to load:', error);
                    replaceIconsWithText();
                }
            } else {
                console.warn('Lucide library not loaded, using emoji fallbacks');
                replaceIconsWithText();
            }
        }

        // Initialize revision system
        function initializeRevisionSystem() {
            revisionEngine = new RevisionEngine();
            updateDynamicContent();
        }

        // Update content based on performance data
        function updateDynamicContent() {
            if (!revisionEngine) return;

            const recommendations = revisionEngine.getRecommendations();
            const weeklyPlan = revisionEngine.getWeeklyPlan();

            // Update priority topics section
            updatePriorityTopics(recommendations.priority);
            
            // Update recommended topics section
            updateRecommendedTopics(recommendations.recommended);
            
            // Update weekly plan
            updateWeeklyPlan(weeklyPlan);
            
            // Update last updated time
            document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
        }

        // Update priority topics dynamically
        function updatePriorityTopics(priorityTopics) {
            const container = document.querySelector('.section:first-child');
            const itemsContainer = container.querySelector('.priority-item').parentNode;
            
            // Clear existing items except the header
            const header = container.querySelector('h2');
            itemsContainer.innerHTML = '';
            itemsContainer.appendChild(header);

            priorityTopics.forEach(topic => {
                const item = createTopicItem(topic, true);
                itemsContainer.appendChild(item);
            });
        }

        // Update recommended topics dynamically
        function updateRecommendedTopics(recommendedTopics) {
            const container = document.querySelector('.section:nth-child(2)');
            const itemsContainer = container.querySelector('.priority-item').parentNode;
            
            // Clear existing items except the header
            const header = container.querySelector('h2');
            itemsContainer.innerHTML = '';
            itemsContainer.appendChild(header);

            recommendedTopics.forEach(topic => {
                const item = createTopicItem(topic, false);
                itemsContainer.appendChild(item);
            });
        }

        // Create topic item element
        function createTopicItem(topic, isPriority) {
            const item = document.createElement('div');
            item.className = `priority-item priority-${topic.priority}`;
            item.onclick = () => startRevision(topic.subject);

            const daysSince = Math.floor((Date.now() - topic.lastStudied) / (24 * 60 * 60 * 1000));
            const lastStudiedText = daysSince === 0 ? 'Today' : 
                                  daysSince === 1 ? 'Yesterday' : 
                                  `${daysSince} days ago`;

            item.innerHTML = `
                <div class="item-header">
                    <div class="item-title">${revisionEngine.formatSubjectName(topic.subject)}</div>
                    <div class="item-score">${topic.score}%</div>
                </div>
                <div class="item-details">
                    <span>üìö ${getSubjectIcon(topic.subject)} ${topic.subject}</span>
                    <span>‚è∞ Last studied: ${lastStudiedText}</span>
                </div>
            `;

            return item;
        }

        // Get subject icon
        function getSubjectIcon(subject) {
            const icons = {
                polity: '‚öñÔ∏è',
                geography: 'üåç',
                history: 'üèõÔ∏è',
                economics: 'üí∞',
                science: 'üî¨',
                environment: 'üå±',
                ethics: '‚öñÔ∏è',
                currentAffairs: 'üì∞'
            };
            return icons[subject] || 'üìö';
        }

        // Update weekly plan
        function updateWeeklyPlan(weeklyPlan) {
            const timeline = document.querySelector('.plan-timeline');
            timeline.innerHTML = '';

            weeklyPlan.forEach((day, index) => {
                const dayCard = document.createElement('div');
                dayCard.className = `day-card ${index === 0 ? 'today' : ''}`;
                
                const dayName = index === 0 ? 'Today' : 
                               index === 1 ? 'Tomorrow' : 
                               `Day ${index + 1}`;

                dayCard.innerHTML = `
                    <div class="day-name">${dayName}</div>
                    <div class="day-topics">
                        ${day.topics.map(topic => `‚Ä¢ ${topic}`).join('<br>')}
                    </div>
                `;

                timeline.appendChild(dayCard);
            });
        }

        // Start revision for specific topic
        function startRevision(topicId) {
            console.log('Starting revision for:', topicId);
            // Add animation
            event.target.style.transform = 'scale(0.95)';
            setTimeout(() => {
                event.target.style.transform = '';
                // Navigate to specific revision content
                window.location.href = `flashcards.html?topic=${topicId}`;
            }, 150);
        }

        // Start smart revision (AI-powered)
        function startSmartRevision() {
            console.log('Starting smart revision');
            // Would analyze performance and start with highest priority topic
            const highestPriorityTopic = 'polity-fundamental-rights';
            window.location.href = `flashcards.html?topic=${highestPriorityTopic}&mode=smart`;
        }

        // Customize study plan
        function customizeStudyPlan() {
            console.log('Opening study plan customization');
            showCustomizationModal();
        }

        // Show customization modal
        function showCustomizationModal() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
            `;

            modal.innerHTML = `
                <div style="
                    background: rgba(255, 255, 255, 0.1);
                    backdrop-filter: blur(10px);
                    border-radius: 15px;
                    padding: 30px;
                    max-width: 500px;
                    width: 90%;
                    color: white;
                    border: 1px solid rgba(255, 255, 255, 0.2);
                ">
                    <h3 style="margin-bottom: 20px; text-align: center;">üéõÔ∏è Customize Study Plan</h3>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 10px;">Daily Study Time (minutes):</label>
                        <input type="range" min="30" max="300" value="120" id="studyTime" style="width: 100%;">
                        <span id="studyTimeValue">120 minutes</span>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 10px;">Focus Areas:</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <label><input type="checkbox" checked> Weak Topics Priority</label>
                            <label><input type="checkbox" checked> Spaced Repetition</label>
                            <label><input type="checkbox"> Current Affairs Daily</label>
                            <label><input type="checkbox"> Mock Tests Weekly</label>
                        </div>
                    </div>

                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button onclick="applyCustomization()" style="
                            padding: 10px 20px;
                            background: linear-gradient(45deg, #667eea, #764ba2);
                            color: white;
                            border: none;
                            border-radius: 20px;
                            cursor: pointer;
                        ">Apply Changes</button>
                        <button onclick="closeModal()" style="
                            padding: 10px 20px;
                            background: rgba(255, 255, 255, 0.2);
                            color: white;
                            border: 1px solid rgba(255, 255, 255, 0.3);
                            border-radius: 20px;
                            cursor: pointer;
                        ">Cancel</button>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);

            // Update study time display
            const slider = modal.querySelector('#studyTime');
            const display = modal.querySelector('#studyTimeValue');
            slider.oninput = () => display.textContent = slider.value + ' minutes';

            // Close modal function
            window.closeModal = () => {
                document.body.removeChild(modal);
                delete window.closeModal;
                delete window.applyCustomization;
            };

            // Apply customization function
            window.applyCustomization = () => {
                const studyTime = slider.value;
                const preferences = {
                    dailyStudyTime: parseInt(studyTime),
                    weakTopicsPriority: modal.querySelector('input[type="checkbox"]:nth-of-type(1)').checked,
                    spacedRepetition: modal.querySelector('input[type="checkbox"]:nth-of-type(2)').checked,
                    currentAffairsDaily: modal.querySelector('input[type="checkbox"]:nth-of-type(3)').checked,
                    mockTestsWeekly: modal.querySelector('input[type="checkbox"]:nth-of-type(4)').checked
                };
                
                localStorage.setItem('studyPreferences', JSON.stringify(preferences));
                closeModal();
                
                // Show success message
                const success = document.createElement('div');
                success.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: rgba(46, 213, 115, 0.9);
                    color: white;
                    padding: 15px 20px;
                    border-radius: 10px;
                    z-index: 1001;
                `;
                success.textContent = '‚úÖ Study plan updated successfully!';
                document.body.appendChild(success);
                
                setTimeout(() => document.body.removeChild(success), 3000);
            };
        }

        // View detailed analytics
        function viewAnalytics() {
            console.log('Opening analytics dashboard');
            window.location.href = 'analytics.html';
        }

        // Simulate daily update of recommendations
        function simulateDailyUpdate() {
            // This would be called by a background service
            const topics = document.querySelectorAll('.priority-item');
            topics.forEach(topic => {
                // Add subtle animation to show content is fresh
                topic.style.animation = 'pulse 0.5s ease-in-out';
            });
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            initializeRevisionSystem();
            
            // Simulate daily updates every 24 hours (in production)
            // For demo, we'll just show the animation
            setTimeout(simulateDailyUpdate, 1000);
        });

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
                if (e.target.classList.contains('priority-item')) {
                    e.target.click();
                }
            }
        });
    </script>
</body>
</html>