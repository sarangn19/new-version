<!DOCTYPE html>
<html>

<head>
    <title>Test Bookmarks</title>
    <script src="js/profile-manager.js"></script>
    <script src="js/enhanced-bookmark-manager.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ccc;
        }

        button {
            padding: 10px 15px;
            margin: 5px;
        }

        #bookmarks-container {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            min-height: 100px;
        }
    </style>
</head>

<body>
    <h1>Bookmark System Test</h1>

    <div class="test-section">
        <h2>Add Test Bookmarks (Profile Manager)</h2>
        <button onclick="addTestBookmark1()">Add News Article</button>
        <button onclick="addTestBookmark2()">Add Study Material</button>
        <button onclick="addTestBookmark3()">Add Video</button>
    </div>

    <div class="test-section">
        <h2>Enhanced Bookmark Manager Tests</h2>
        <button onclick="testEnhancedBookmarks()">Test Enhanced Features</button>
        <button onclick="testBulkOperations()">Test Bulk Operations</button>
        <button onclick="testCategories()">Test Categories</button>
        <button onclick="testSearch()">Test Search</button>
    </div>

    <div class="test-section">
        <h2>Bookmarks Display</h2>
        <div id="bookmarks-container">
            <!-- Bookmarks will appear here -->
        </div>
    </div>

    <div class="test-section">
        <h2>Actions</h2>
        <button onclick="showBookmarkCount()">Show Bookmark Count</button>
        <button onclick="clearAllBookmarks()">Clear All Bookmarks</button>
        <button onclick="refreshDisplay()">Refresh Display</button>
    </div>

    <div class="test-section">
        <h2>Instructions</h2>
        <p>1. Add some test bookmarks using the buttons above</p>
        <p>2. Check that they appear in the bookmarks display</p>
        <p>3. Go to profile.html and check the bookmarks section</p>
        <p>4. Go to news.html and bookmark some articles</p>
        <p>5. Return here to see if they appear</p>
    </div>

    <script>
        function addTestBookmark1() {
            if (window.profileManager) {
                profileManager.addBookmark({
                    title: 'Supreme Court Landmark Judgment',
                    category: 'Legal News',
                    type: 'news',
                    url: '#'
                });
                refreshDisplay();
                alert('News article bookmarked!');
            }
        }

        function addTestBookmark2() {
            if (window.profileManager) {
                profileManager.addBookmark({
                    title: 'Indian Constitution Study Guide',
                    category: 'Study Material',
                    type: 'article',
                    url: '#'
                });
                refreshDisplay();
                alert('Study material bookmarked!');
            }
        }

        function addTestBookmark3() {
            if (window.profileManager) {
                profileManager.addBookmark({
                    title: 'Economics Explained Video',
                    category: 'Educational',
                    type: 'video',
                    url: '#'
                });
                refreshDisplay();
                alert('Video bookmarked!');
            }
        }

        function showBookmarkCount() {
            if (window.profileManager) {
                const count = profileManager.getBookmarks().length;
                alert(`You have ${count} bookmarks`);
            }
        }

        function clearAllBookmarks() {
            if (window.profileManager && confirm('Clear all bookmarks?')) {
                const bookmarks = profileManager.getBookmarks();
                bookmarks.forEach(bookmark => {
                    profileManager.removeBookmark(bookmark.id);
                });
                refreshDisplay();
                alert('All bookmarks cleared!');
            }
        }

        function refreshDisplay() {
            if (window.profileManager) {
                profileManager.updateBookmarksDisplay();
            }
        }

        // Initialize display when page loads
        function initializeBookmarks() {
            if (window.profileManager) {
                try {
                    profileManager.updateBookmarksDisplay();
                    console.log('Bookmarks initialized:', profileManager.getBookmarks());
                } catch (error) {
                    console.error('Error initializing bookmarks:', error);
                }
            } else {
                console.error('ProfileManager not available');
                // Retry after a short delay
                setTimeout(initializeBookmarks, 200);
            }
        }

        // Enhanced bookmark manager test functions
        function testEnhancedBookmarks() {
            if (!window.enhancedBookmarkManager) {
                alert('Enhanced bookmark manager not available!');
                return;
            }

            const testBookmark = {
                title: 'Enhanced Test Bookmark',
                url: 'https://example.com/enhanced',
                description: 'This is a test bookmark with enhanced features',
                category: 'general',
                tags: ['test', 'enhanced']
            };

            const bookmark = window.enhancedBookmarkManager.addBookmark(testBookmark);
            alert(`Enhanced bookmark added with ID: ${bookmark.id}`);
            refreshDisplay();
        }

        function testBulkOperations() {
            if (!window.enhancedBookmarkManager) {
                alert('Enhanced bookmark manager not available!');
                return;
            }

            // Add multiple bookmarks for testing
            const bookmarks = [
                { title: 'Bulk Test 1', category: 'general' },
                { title: 'Bulk Test 2', category: 'general' },
                { title: 'Bulk Test 3', category: 'general' }
            ];

            const addedBookmarks = bookmarks.map(b => window.enhancedBookmarkManager.addBookmark(b));
            
            // Select them for bulk operations
            addedBookmarks.forEach(b => window.enhancedBookmarkManager.selectedBookmarks.add(b.id));
            
            alert(`Added ${addedBookmarks.length} bookmarks and selected them for bulk operations`);
            refreshDisplay();
        }

        function testCategories() {
            if (!window.enhancedBookmarkManager) {
                alert('Enhanced bookmark manager not available!');
                return;
            }

            const testCategory = {
                name: 'Test Category',
                color: '#FF6B6B',
                icon: 'star',
                description: 'A test category'
            };

            const category = window.enhancedBookmarkManager.addCategory(testCategory);
            alert(`Category added: ${category.name} with ID: ${category.id}`);
        }

        function testSearch() {
            if (!window.enhancedBookmarkManager) {
                alert('Enhanced bookmark manager not available!');
                return;
            }

            const results = window.enhancedBookmarkManager.searchBookmarks('test');
            alert(`Search for 'test' returned ${results.length} results`);
        }

        // Try to initialize immediately, then with delay if needed
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeBookmarks);
        } else {
            initializeBookmarks();
        }
    </script>
</body>

</html>